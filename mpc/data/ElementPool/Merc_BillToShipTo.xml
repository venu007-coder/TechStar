<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE ELEMENT SYSTEM "/u/web/altec2/mpc/data/dtd/element.dtd">
<ELEMENT>
	<VERSION>1</VERSION>
	<TYPE>Merc_BillToShipTo</TYPE>
	<GLOBAL TYPE="never"></GLOBAL>
	<UIGRAPHIC></UIGRAPHIC>
	<UITEXT></UITEXT>
	<!-- No delete -->
	<PERMISSIONS>666</PERMISSIONS>
	<PROPERTIES>
		<PROPERTY NAME="width">
			<VALUE>500</VALUE>
		</PROPERTY>
		<PROPERTY NAME="height">
			<VALUE>870</VALUE>
		</PROPERTY>
		<PROPERTY NAME="style">
			<VALUE>text-body</VALUE>
		</PROPERTY>
		<PROPERTY NAME="reqFields">
			<VALUE>BillToName	BillToAddress1	BillToSubRegion	BillToRegion	BillToPostalCode	BillToCountry	BillToDaytimePhone	BillToEveningPhone	BillToEmailAddress	shippingZone	ShipToName	ShipToAddress1	ShipToSubRegion	ShipToRegion	ShipToPostalCode	ShipToCountry	ShipToDaytimePhone	ShipToEveningPhone</VALUE>
		</PROPERTY>
		<PROPERTY NAME="btnstyle">
			<VALUE>btn-shopperbackground</VALUE>
		</PROPERTY>
		<PROPERTY NAME="securebtnstyle">
			<VALUE>secure-btn-shopperbackground</VALUE>
		</PROPERTY>
		<PROPERTY NAME="btntextstyle">
			<VALUE>btn-shoppertext</VALUE>
		</PROPERTY>
	</PROPERTIES>
	<SCRIPT NAME="common" TYPE="common" VERSION="1.0"><![CDATA[
	]]></SCRIPT>
	<SCRIPT NAME="output" TYPE="output" VERSION="1.0"><![CDATA[
	function output(type)
	{
		var scriptFile = doActionEx('DATA_READFILE', 'common.js', 'FileName', 
					'common.js','ObjectName', 'JS_SRC', 'FileType', 'txt');
		eval (scriptFile);
		if (type == "text/html")
		{
			var mode = doAction('ST_GET_STATEDATA', 'PE_OutputMode', 'PE_OutputMode');
			write('<div id="newLayer'+merc_elementid+'" name="newLayer'+merc_elementid+'" ');
			if (style && style != '')
			{
				write(' class="'+style+'" ');
			}
			write('style="position:absolute; width:'+width+'px; ');
			write('height:'+height+'px; left:'+merc_xpos+'px; top:'+merc_ypos+'px;');
			write('z-index:'+merc_zindex+';">');

			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln('var default_locale = "en";');

			writeln('	// First, define our Objects');
			writeln('	function Country(id, shortname, longname)');
			writeln('	{');
			writeln('		this.ID = id;');
			writeln('		this.ShortName = shortname;');
			writeln('		this.LongName = longname;');
			writeln('	}');

			writeln('	function Region(id, shortname, longname)');
			writeln('	{');
			writeln('		this.ID = id;');
			writeln('		this.ShortName = shortname;');
			writeln('		this.LongName = longname;');
			writeln('	}');

			writeln('	// Get list of allowed Countries');
			writeln('	var CountryList = new Array();');
			writeln('	var numCountries = 0;');

			writeln('	var qID = doActionEx("DATA_OPENQUERY", "QueryID","ObjectName", "TAX_COUNTRY", "Sort", "ID ASC");');
			writeln('	while(!doActionEx("DATA_ISEOF","Result","QueryID",qID, "ObjectName", "TAX_COUNTRY"))');
			writeln('	{');
			writeln('		var resultset = doActionBDO("DATA_GETROWDATA","ObjectName", "TAX_COUNTRY", "QueryID",qID);');
			writeln('		CountryList[numCountries] = new Country(resultset.ID, resultset.SHORTNAME, resultset.LONGNAME);');
			writeln('		numCountries++;');
			writeln('		var movednext=doActionEx("DATA_MOVENEXT","Result","ObjectName","TAX_COUNTRY","QueryID",qID);');
			writeln('	}');
			writeln('	var closeConn = doAction("DATA_CLOSEQUERY", "QueryID",qID,"ObjectName", "TAX_COUNTRY");');
			writeln('	// Get list of allowed Regions (States)');
			writeln('	var RegionList = new Array();');
			writeln('	var numRegions = 0;');

			writeln('	var qID = doActionEx("DATA_OPENQUERY", "QueryID","ObjectName", "TAX_REGION", "Sort", "ID ASC");');
			writeln('	while(!doActionEx("DATA_ISEOF","Result","QueryID",qID, "ObjectName", "TAX_REGION"))');
			writeln('	{');
			writeln('		var resultset = doActionBDO("DATA_GETROWDATA","ObjectName", "TAX_REGION", "QueryID",qID);');
			writeln('		RegionList[numRegions] = new Region(resultset.ID, resultset.SHORTNAME, resultset.LONGNAME);');
			writeln('		numRegions++;');
			writeln('		var movednext=doActionEx("DATA_MOVENEXT","Result","ObjectName","TAX_REGION","QueryID",qID);');
			writeln('	}');
			writeln('	var closeConn = doAction("DATA_CLOSEQUERY", "QueryID",qID,"ObjectName", "TAX_REGION");');

			write('</scr');
				writeln('ipt>');

			writeln('<merc_dynamic noshow=true name=storeLogo action=DATA_GETLITERAL return=Result ObjectName=storecfg LiteralID=StoreLogo>');
			writeln('<merc_dynamic noshow=true name=siteID action=REQ_GET_FORMVALUE return=Result SiteID=SiteID>');
			writeln('<merc_dynamic noshow=true name=appID action=REQ_GET_FORMVALUE return=Result AppID=AppID>');
			writeln('<merc_dynamic noshow=true name=sessionID action=REQ_GET_FORMVALUE return=Result SessionID=SessionID>');
			writeln('<merc_dynamic name=billToRow noshow=true action=SC_GET_FIRST_ROW return=RowName TableName=BillTo>');
			writeln('<merc_dynamic name=shipToRow noshow=true action=SC_GET_FIRST_ROW return=RowName TableName=ShipTo>');

			var urlpath = doActionEx("DATA_GETLITERAL", "Result", "ObjectName", "storecfg", "LiteralID", "SiteUrl");
			writeln('<form method=POST name="BillToShipToForm" action="'+urlpath+'">');
			writeln('<input type=hidden name="reqFields" value="'+reqFields+'">');
			
			writeln('<input type=hidden name=SessionID value=sessionID>');
			writeln('<input type=hidden name=sh_action value="setBillToShipTo">');
			writeln('<input type=hidden name=SiteID value=siteID>');
			writeln('<input type=hidden name=AppID value=appID>');

			if (mode == "PE_PreviewMode")
				writeln('<input type=hidden name=Preview value=1>');

			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln('var caller= doAction("REQ_GET_FORMVALUE", "Caller", "Caller");');
/* I changed this from if(call !=undefined) */
			writeln('if (!caller)');
/* I changed this from caller = "ModCart" */
			writeln('	caller = "BillToShipTo";');
			writeln('writeln("<input type=hidden name=\'Caller\' value=\'" + caller + "\'>");');

			writeln("var missingFields = doAction('ST_GET_STATEDATA','BTST_MISSING_FIELDS','BTST_MISSING_FIELDS');");
			writeln('if (missingFields && missingFields.length > 0)');
			writeln('{');
			writeln("	missingFields = missingFields.split(',');");
			writeln("	writebr('The following required fields were not entered:<br>');");

			writeln('	for (var k = 0; k < missingFields.length; k++)');
			writeln('		writebr(missingFields[k]);');
			writeln('}');

			writeln("var badCharFields = doAction('ST_GET_STATEDATA','BTST_BADCHAR_FIELDS','BTST_BADCHAR_FIELDS');");
			writeln('if (badCharFields && badCharFields.length > 0)');
			writeln('{');
			writeln("	badCharFields = badCharFields.split(',');");
			writeln("	var badCharTypes = doAction('ST_GET_STATEDATA','BTST_BADCHAR_TYPES','BTST_BADCHAR_TYPES');");
			writeln("	writebr('Please do not use the following characters in your entries:<br>' +");
			writeln("	badCharTypes + '<br>' + ");
			writeln("	'The following fields contain illegal characters:<br>');");

			writeln('	for (var k = 0; k < badCharFields.length; k++)');
			writeln('		writebr(badCharFields[k]);');
			writeln('}');
			write('</scr');
				writeln('ipt>');

			writeln('<!-- Display the billing info table -->');
			writeln('<table width="500" border="0" cellpadding="0" cellspacing="0" align="center">');
			writeln('	<tr bgcolor="#333333">');
			writeln('		<td nowrap colspan="4">');
			writeln('			<div align="center">');
			writeln('			<b><font color="#FFFFFF">Billing Address</font></b>');
			writeln('			</div>');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Name:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=billToName noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=BillToName>');
			writeln('			<input type="text" name="BillToName"  value="{billToName}" size="30" maxlength="60">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Address:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=billToAddress1 noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=Address1>');
			writeln('			<input type="text" name="BillToAddress1"  value="{billToAddress1}" size="30" maxlength="80">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Address continued:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=billToAddress2 noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=Address2>');
			writeln('			<input type="text" name="BillToAddress2"  value="{billToAddress2}" size="30" maxlength="80">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;City:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=billToSubRegion noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=SubRegion>');
			writeln('			<input type="text" name="BillToSubRegion"  value="{billToSubRegion}" size="30" maxlength="60">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;State/Province:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			
			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln("		var billToRowName = doActionEx('SC_GET_FIRST_ROW', 'RowName','TableName', 'BillTo');");
			writeln('		var region= MERC_SHOPCART.GetField("BillTo",billToRowName,"Region");');

			writeln('		write("<SELECT NAME=\\"BillToRegion\\">\\n<OPTION VALUE=\\"\\">None</OPTION>");');
			writeln('		for (var i=0; i < numRegions; i++)');
			writeln('		{');
			writeln('			if (region == RegionList[i].ID)');
			writeln('				SelectedFlag=" SELECTED ";');
			writeln('			else');
			writeln('				SelectedFlag=" ";');

			writeln('			writeln("<OPTION VALUE=\\"" + RegionList[i].ID + "\\"" + SelectedFlag + ">" + RegionList[i].LongName + "</OPTION>");');
			writeln('		}');
			writeln('		writeln("\\n</SELECT>");');
			write('</SCR');
				writeln('IPT>');
			
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Postal Code:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=billToPostalCode noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=PostalCode>');
			writeln('			<input type="text" name="BillToPostalCode"  value="{billToPostalCode}" size="30" maxlength="40">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Country:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');

			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln("		var billToRowName = doActionEx('SC_GET_FIRST_ROW', 'RowName','TableName', 'BillTo');");
			writeln('		var country= MERC_SHOPCART.GetField("BillTo",billToRowName,"Country");');
			writeln('		writeln("<SELECT NAME=\\"BillToCountry\\">");');
			writeln('		var SelectedFlag="";');
			writeln('		for (var i=0; i < numCountries; i++)');
			writeln('		{');
			writeln('			if (country == CountryList[i].ID)');
			writeln('				SelectedFlag=" SELECTED ";');
			writeln('			else');
			writeln('				SelectedFlag=" ";');
			writeln('			writeln("<OPTION VALUE=\\"" + CountryList[i].ID + "\\"" + SelectedFlag + ">" + CountryList[i].LongName + "</OPTION>");');
			writeln('		}');
			writeln('		writeln("\\n</SELECT>");');
			write('</SCR');
				writeln('IPT>');

			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('				<b>&nbsp;Daytime Phone:</b>');
			writeln('			</td>');
			writeln('			<td width="220">');
			writeln('				<merc_dynamic name=billToDaytimePhone noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=DaytimePhone>');
			writeln('				<input type="text" name="BillToDaytimePhone"  value="{billToDaytimePhone}" size="16" maxlength="16">');
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('				<b>&nbsp;Evening Phone:</b>');
			writeln('			</td>');
			writeln('			<td width="220">');
			writeln('				<merc_dynamic name=billToEveningPhone noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=EveningPhone>');
			writeln('				<input type="text" name="BillToEveningPhone"  value="{billToEveningPhone}" size="16" maxlength="16">');
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('				<b>&nbsp;E-mail Address:</b>');
			writeln('			</td>');
			writeln('			<td width="220">');
			writeln('				<merc_dynamic name=billToEmailAddress noshow=true action=SC_GET_FIELD return=Result TableName=BillTo RowName={billToRow} FieldName=EmailAddress>');
			writeln('				<input type="text" name="BillToEmailAddress"  value="{billToEmailAddress}" size="30" maxlength="40">');
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td width="450" nowrap colspan="2">');
			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln('		var crmPicked = MERC_SHOPCART.GetField("BillTo",billToRowName,"crmquery");');
			writeln('		var checked = "";');
			writeln('		if 	(crmPicked && crmPicked.toLowerCase() == "no")');
			writeln('		{');
			writeln('			writeln (\'<input type="radio" name="crmquery"  value="Yes">\');');
			writeln('			checked = " checked";');
			writeln('		}');
			writeln('		else');
			writeln('			writeln (\'<input type="radio" name="crmquery"  value="Yes" checked>\');');
			write('</SCR');
				writeln('IPT>');
			writeln("				&nbsp;Yes, I'd like to receive special offers.");
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td width="450" nowrap colspan="2">');
			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln('		writeln (\'<input type="radio" name="crmquery"  value="No"\' + checked + \'>\');');
			write('</SCR');
				writeln('IPT>');
			writeln("				&nbsp;No, I'd prefer not to be contacted with any special offers.");
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" nowrap colspan="4" height="4"><img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/1x1.gif" height="1" width="500" border="0"></td>');
			writeln('		</tr>');
			writeln('	</table>');

			writeln('	<!-- Display the shipping zone table -->');
			writeln('	<br>');
			writeln('	<table width="500" border="0" cellpadding="0" cellspacing="0" align="center">');
			writeln('		<tr bgcolor="#333333">');
			writeln('			<td nowrap colspan="4">');
			writeln('				<div align="center">');
			writeln('				<b><font color="#FFFFFF">Shipping Information</font></b>');
			writeln('				</div>');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td bgcolor="#CCCCCC" width="178" nowrap>');
			writeln('				<b>&nbsp;Shipping:</b>');
			writeln('			</td>');
			writeln('			<td width="314">');
			writeln('			<!-- SELECT THE SHIPPING ZONE -->');

			write('<scr');
			writeln('ipt runat=merc_server>');
			writeln('			var sessionShippingZoneID = doActionEx("SHIP_GET_ZONE","ShippingZone");');
			writeln('			var bMatch = false;');
			writeln('			var options = "";');
			writeln('			// query the shipping zone table to get the next (first) shipping zone');
			writeln('			var theBDO = doActionBDO("DATA_OPENQUERY", "ObjectName", "SHIP_ZONE");');
			writeln('			var qID = theBDO.QueryID;');
			writeln('			// at the end of the table?');
			writeln('			if (qID > 0)');
			writeln('			{');
			writeln('				while(!doActionEx("DATA_ISEOF","Result","QueryID", qID, "ObjectName", "SHIP_ZONE"))');
			writeln('				{');
			writeln('					// get the name lit id');
			writeln('					var shippingZoneResultSet=doActionBDO("DATA_GETFIELDDATA", "ObjectName", "SHIP_ZONE","QueryID", qID,"FieldName","NAME_LIT_ID");');
			writeln('					var shippingZoneID=doActionBDO("DATA_GETFIELDDATA", "ObjectName", "SHIP_ZONE","QueryID",qID,"FieldName","ID");');
			writeln('					// the localeText table is queried for the text description of the shipping zone');
			writeln('					var LIT_TEXT = doActionEx("DATA_GETLOCALESTRING", "LiteralValue", "ObjectName", "SHIP_LITERALS","Locale","en","LiteralID",shippingZoneResultSet.NAME_LIT_ID);');
			writeln('					// get the locale text that the name lit id corresponds to');
			writeln('					// display dropdown selection box for shipping zone');
			writeln('					if(shippingZoneID.ID == sessionShippingZoneID)');
			writeln('						options += "<option value=\\"" + shippingZoneID.ID + "\\" selected>";');
			writeln('					else');
			writeln('						options += "<option value=\\"" + shippingZoneID.ID +"\\">";');
			writeln('					options += LIT_TEXT;');
			writeln('					options += "</option>";');
			writeln('					// move to the next row of the previously opened shipping query');
			writeln('					var movednext = doActionEx("DATA_MOVENEXT","Result","QueryID", qID, "ObjectName", "SHIP_ZONE")');
			writeln('				}');
			writeln('				doAction("DATA_CLOSEQUERY","ObjectName", "SHIP_ZONE","QueryID", qID);');
			writeln('			}');
			writeln('			if (options)');
			writeln('			{');
			writeln('				writeln ( "<select name=\\"shippingZone\\">" + options + "</select>");');
			writeln('			}');
			writeln('			else');
			writeln('			{');
			writeln('				writeln ( "<input type=hidden name=\\"shippingZone\\" value=\\"\\">N/A" );');
			writeln('			}');
			write('</scr');
			writeln('ipt>');

			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
		
			writeln('		<td colspan="2" width="492" nowrap>');
			writeln('			<center>');

			write('<scr');
				writeln('ipt runat=merc_server>');
			writeln("		var shipToRowName = doActionEx('SC_GET_FIRST_ROW', 'RowName','TableName', 'ShipTo');");
			writeln('		var shipToSameAsBillTo = "false";');
			writeln('		shipToSameAsBillTo= MERC_SHOPCART.GetField("ShipTo",shipToRowName,"SameAsBillTo");');
			writeln('		if(shipToSameAsBillTo=="true")');
			writeln('			writeln(\'<input type="checkbox" name="ShipToSameAsBillTo"  value="true" CHECKED>\');');
			writeln('		else');
			writeln('			writeln(\'<input type="checkbox" name="ShipToSameAsBillTo"  value="true">\');');
			write('</scr');
				writeln('ipt>');
			writeln('				Ship-To address same as Bill-To address');
			writeln('			</center>');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" nowrap colspan="4" height="4"><img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/1x1.gif" height="1" width="500" border="0"></td>');
			writeln('	</tr>');
			writeln('</table>');
			writeln('<!-- end shipping zone table-->');

			writeln('<!-- Display the shipping info table -->');
			writeln('<br>');
			writeln('<table width="500" border="0" cellpadding="0" cellspacing="0" align="center">');
			writeln('	<tr bgcolor="#333333">');
			writeln('		<td width="100%" nowrap colspan="4">');
			writeln('			<div align="center">');
			writeln('			<b><font color="#FFFFFF">Shipping Address</font></b>');
			writeln('			<font color="#FFFFFF">(if different from above)</font>');
			writeln('			</div>');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Name:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=shipToName noshow=true action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=ShipToName>');
			writeln('			<input type="text" name="ShipToName"  value="{shipToName}" size="30" maxlength="60">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Address:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=shipToAddress1 noshow=true action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=Address1>');
			writeln('			<input type="text" name="ShipToAddress1"  value="{shipToAddress1}" size="30" maxlength="80">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Address continued:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=shipToAddress2 noshow=true action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=Address2>');
			writeln('			<input type="text" name="ShipToAddress2"  value="{shipToAddress2}" size="30" maxlength="80">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;City:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=shipToSubRegion noshow=true action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=SubRegion>');
			writeln('			<input type="text" name="ShipToSubRegion"  value="{shipToSubRegion}" size="30" maxlength="60">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC"  width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;State/Province:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			
			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln("		var shipToRowName = doActionEx('SC_GET_FIRST_ROW', 'RowName','TableName', 'ShipTo');");
			writeln('		var region= MERC_SHOPCART.GetField("ShipTo",shipToRowName,"Region");');
			writeln('		write("<SELECT NAME=\\"ShipToRegion\\">\\n<OPTION VALUE=\\"\\">None</OPTION>");');
			writeln('		for (var i=0; i < numRegions; i++)');
			writeln('		{');
			writeln('			if (region == RegionList[i].ID)');
			writeln('				SelectedFlag=" SELECTED ";');
			writeln('			else');
			writeln('				SelectedFlag=" ";');
			writeln('			writeln("<OPTION VALUE=\\"" + RegionList[i].ID + "\\"" + SelectedFlag + ">" + RegionList[i].LongName + "</OPTION>");');
			writeln('		}');
			writeln('		writeln("\\n</SELECT>");');
			write('</SCR');
				writeln('IPT>');
			
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Postal Code:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('			<merc_dynamic name=shipToPostalCode noshow=true action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=PostalCode>');
			writeln('			<input type="text" name="ShipToPostalCode"  value="{shipToPostalCode}" size="30" maxlength="40">');
			writeln('		</td>');
			writeln('		<td width="4" bgcolor="#CCCCCC">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('			<b>&nbsp;Country:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');

			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln('		var country= MERC_SHOPCART.GetField("ShipTo",shipToRowName,"Country");');
			writeln('		writeln("<SELECT NAME=\\"ShipToCountry\\">");');
			writeln('		var SelectedFlag="";');
			writeln('		for (var i=0; i < numCountries; i++)');
			writeln('		{');
			writeln('			if (country == CountryList[i].ID)');
			writeln('				SelectedFlag=" SELECTED ";');
			writeln('			else');
			writeln('				SelectedFlag=" ";');
			writeln('			writeln("<OPTION VALUE=\\"" + CountryList[i].ID + "\\"" + SelectedFlag + ">" + CountryList[i].LongName + "</OPTION>");');
			writeln('		}');
			writeln('		writeln("\\n</SELECT>");');
			write('</SCR');
				writeln('IPT>');
			
			writeln('		</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('				<b>&nbsp;Daytime Phone:</b>');
			writeln('			</td>');
			writeln('			<td width="220">');
			writeln('				<merc_dynamic name=shipToDaytimePhone noshow=true action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=DaytimePhone>');
			writeln('				<input type="text" name="ShipToDaytimePhone"  value="{shipToDaytimePhone}" size="16" maxlength="16">');
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" width="4">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('			<td bgcolor="#CCCCCC" width="175" nowrap>');
			writeln('				<b>&nbsp;Evening Phone:</b>');
			writeln('			</td>');
			writeln('			<td width="220">');
			writeln('				<merc_dynamic name=shipToEveningPhone noshow=true action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=EveningPhone>');
			writeln('				<input type="text" name="ShipToEveningPhone"  value="{shipToEveningPhone}" size="16" maxlength="16">');
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('	</tr>');
			writeln('	<tr>');
			writeln('		<td bgcolor="#CCCCCC" width="4">');
			writeln('			&nbsp;');
			writeln('		</td>');
			writeln('		<td bgcolor="#CCCCCC" width="175" nowrap valign="top">');
			writeln('			<b>&nbsp;Special Instructions:</b>');
			writeln('		</td>');
			writeln('		<td width="220">');
			writeln('<textarea name="Special" cols="35" rows="5">');
			writeln('<merc_dynamic name=special noshow=false action=SC_GET_FIELD return=Result TableName=ShipTo RowName={shipToRow} FieldName=Special>');
			writeln('</textarea>');
			writeln('			</td>');
			writeln('			<td width="4" bgcolor="#CCCCCC">');
			writeln('				&nbsp;');
			writeln('			</td>');
			writeln('		</tr>');
			writeln('		<tr>');
			writeln('			<td bgcolor="#CCCCCC" nowrap colspan="4" height="4"><img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/1x1.gif" height="1" width="500" border="0"></td>');
			writeln('		</tr>');
			writeln('	</table>');
			writeln('	<script language="javascript">');
			writeln('		document.BillToShipToForm.BillToName.focus();');
			writeln('	</script>');
			writeln('	<p align="center">');

			write('<SCR');
				writeln('IPT runat="merc_server">');
			writeln('var theCaller = doAction("ST_GET_STATEDATA","Caller","Caller");');
			writeln("if (theCaller == 'checkout')");
			writeln('{');
			writeln('	writeln("<br><center>");');
			writeln('	writeln("<table border=0 cellspacing=0 cellpadding=0><tr>");');
			var currentPage = doAction('ST_GET_STATEDATA', 'CurrentPageName', 'CurrentPageName');
			var seObj = generateSEObjects (currentPage);
			var pageObj = seObj.pageObjArray[currentPage];
			if (mode != "PE_EditMode" && pageObj.SecureBaseHref.toLowerCase() == "yes")
				writeln('	writeln("<td align=right valign=middle width=120 height=22 class=\''+securebtnstyle+'\'>");');
			else
				writeln('	writeln("<td align=right valign=middle width=120 height=22 class=\''+btnstyle+'\'>");');
			writeln('	writeln(\'<a href="#" onClick="document.BillToShipToForm.submit();return false;">\');');
			writeln('	writeln(\'<center><span class="'+btntextstyle+'">Continue Checkout</span></center></a>\');');
			writeln("	writeln('</td></tr></table></center>');");
			writeln('	writeln(\'<input type="hidden" name="Submit" value="Continue Checkout">\');');
			writeln('}');
			writeln('else');
			writeln('{');
			writeln('	writeln(\'<input type="hidden" name="Submit" value="Continue Shopping">\');');
			writeln('	writeln("<br><center>");');
			writeln('	writeln("<table border=0 cellspacing=0 cellpadding=0><tr>");');
			if (mode != "PE_EditMode" && pageObj.SecureBaseHref.toLowerCase() == "yes")
				writeln('	writeln("<td align=right valign=middle width=120 height=22 class=\''+securebtnstyle+'\'>");');
			else
				writeln('	writeln("<td align=right valign=middle width=120 height=22 class=\''+btnstyle+'\'>");');
			writeln('	writeln(\'<a href="#" onClick="document.BillToShipToForm.submit();return false;">\');');
			writeln('	writeln(\'<center><span class="'+btntextstyle+'">Continue Shopping</span></center></a>\');');
			writeln("	writeln('</td>');");
			writeln('	writeln("<td>&nbsp;</td>");');
			if (mode != "PE_EditMode" && pageObj.SecureBaseHref.toLowerCase() == "yes")
				writeln('	writeln("<td align=right valign=middle width=120 height=22 class=\''+securebtnstyle+'\'>");');
			else
				writeln('	writeln("<td align=right valign=middle width=120 height=22 class=\''+btnstyle+'\'>");');
			writeln('	writeln(\'<a href="#" onClick="document.BillToShipToForm.Submit.value=\\\'Show Cart\\\';document.BillToShipToForm.submit();return false;">\');');
			writeln('	writeln(\'<center><span class="'+btntextstyle+'">Show Cart</span></center></a>\');');
			writeln("	writeln('</td></tr></table></center>');");
			writeln('}');
			write('</scr');
				writeln('ipt>');
			writeln('		</p>');
			writeln('	</form>');

			write('</div>');
			return true;
		}
		else if (type == "text/wml")
		{
			// output WML
		}
	}
	]]></SCRIPT>
	<SCRIPT NAME="output_edit_mode" TYPE="output_edit_mode" VERSION="1.0"><![CDATA[
	function output_edit_mode(type)
	{
		if (type == "text/html")
		{
			write('<div id="newLayer'+merc_elementid+'" name="newLayer'+merc_elementid+'" ');
			if (style && style != '')
			{
				write(' class="'+style+'" ');
			}
			write('style="position:absolute; width:'+width+'px; ');
			write('height:'+height+'px; left:'+merc_xpos+'px; top:'+merc_ypos+'px;');
			write('z-index:'+merc_zindex+';">');

			<merc_embed>

			<form action="javascript:void(0);" name="BillToShipToForm">
<!-- Display the billing info table -->
	<table width="500" border="0" cellpadding="0" cellspacing="0" align="center">
		<tr bgcolor="#333333">
			<td nowrap colspan="4">
				<div align="center">
					<b>
						<font color="#FFFFFF">
							Billing Address
						</font>
					</b>
				</div>
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Name:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToName"  value="" size="30" maxlength="60">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Address:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToAddress1"  value="" size="30" maxlength="80">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Address continued:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToAddress2"  value="" size="30" maxlength="80">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;City:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToSubRegion"  value="" size="30" maxlength="60">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;State/Province:
				</b>
			</td>
			<td width="220">
				<SELECT NAME="BillToRegion"></SELECT>
				
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Postal Code:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToPostalCode"  value="" size="30" maxlength="40">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Country:
				</b>
			</td>
			<td width="220">
				<SELECT NAME="BillToCountry"></SELECT>
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Daytime Phone:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToDaytimePhone"  value="" size="16" maxlength="16">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Evening Phone:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToEveningPhone"  value="" size="16" maxlength="16">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;E-mail Address:
				</b>
			</td>
			<td width="220">
				<input type="text" name="BillToEmailAddress"  value="" size="30" maxlength="40">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" nowrap colspan="4" height="4"><img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/1x1.gif" height="1" width="500" border="0"></td>
		</tr>
	</table>
	<!-- Display the shipping zone table -->
	<br>
	<table width="500" border="0" cellpadding="0" cellspacing="0" align="center">
		<tr bgcolor="#333333">
			<td nowrap colspan="4">
				<div align="center">
					<b>
						<font color="#FFFFFF">
							Shipping Information
						</font>
					</b>
				</div>
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="178" nowrap>
				<b>
					&nbsp;Shipping:
				</b>
			</td>
			<td width="314">
				<!-- SELECT THE SHIPPING ZONE -->
				<select name='shippingZone'></select>
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			
			<td colspan="2" width="492" nowrap>
				<center>
					<input type="checkbox" name="ShipToSameAsBillTo"  value="true">
					Ship-To address same as Bill-To address
				</center>
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
			
		</tr>
		
		<tr>
			<td bgcolor="#CCCCCC" nowrap colspan="4" height="4"><img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/1x1.gif" height="1" width="500" border="0"></td>
		</tr>
	</table>
	<!-- end shipping zone table-->

	<!-- Display the shipping info table -->
	<br>
	<table width="500" border="0" cellpadding="0" cellspacing="0" align="center">
		<tr bgcolor="#333333">
			<td width="100%" nowrap colspan="4">
				<div align="center">
					<b>
						<font color="#FFFFFF">
							Shipping Address
						</font>
					</b>
					<font color="#FFFFFF">
						(if different from above)
					</font>
				</div>
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Name:
				</b>
			</td>
			<td width="220">
				<input type="text" name="ShipToName"  value="" size="30" maxlength="60">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Address:
				</b>
			</td>
			<td width="220">
				<input type="text" name="ShipToAddress1"  value="" size="30" maxlength="80">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Address continued:
				</b>
			</td>
			<td width="220">
				<input type="text" name="ShipToAddress2"  value="" size="30" maxlength="80">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;City:
				</b>
			</td>
			<td width="220">
				<input type="text" name="ShipToSubRegion"  value="" size="30" maxlength="60">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC"  width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;State/Province:
				</b>
			</td>
			<td width="220">
				<SELECT NAME="ShipToRegion"></SELECT>	
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Postal Code:
				</b>
			</td>
			<td width="220">
				<input type="text" name="ShipToPostalCode"  value="" size="30" maxlength="40">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Country:
				</b>
			</td>
			<td width="220">
				<SELECT NAME="ShipToCountry"></SELECT>	
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Daytime Phone:
				</b>
			</td>
			<td width="220">
				<input type="text" name="ShipToDaytimePhone"  value="" size="16" maxlength="16">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap>
				<b>
					&nbsp;Evening Phone:
				</b>
			</td>
			<td width="220">
				<input type="text" name="ShipToEveningPhone"  value="" size="16" maxlength="16">
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" width="4">
				&nbsp;
			</td>
			<td bgcolor="#CCCCCC" width="175" nowrap valign="top">
				<b>
					&nbsp;Special Instructions:
				</b>
			</td>
			<td width="220">
				<textarea name="Special" cols="35" rows="5"></textarea>
			</td>
			<td width="4" bgcolor="#CCCCCC">
				&nbsp;
			</td>
		</tr>
		<tr>
			<td bgcolor="#CCCCCC" nowrap colspan="4" height="4"><img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/1x1.gif" height="1" width="500" border="0"></td>
		</tr>
	</table>
</form>
</merc_embed>

			write('</div>');
			return true;
		}
		else if (type == "text/wml")
		{
			// output WML
		}
	}
	]]></SCRIPT>
	<SCRIPT NAME="edit_properties" TYPE="edit_properties" VERSION="1.0"><![CDATA[
	function isInArray (key, arrayToSearch)
	{
		for (var n = 0; n < arrayToSearch.length; n++)
		{
			if (arrayToSearch[n].toLowerCase() == key.toLowerCase())
				return true;
		}
		return false;
	}
	function edit_properties()
	{
		//write out html for EditProperties dialog box
		// use table tags to position stuff better?
		// The input "names" have to match the <name> tags above.
		write('<form action="javascript:void(0)" name="saveprop">');
		var addEditMode = doAction('REQ_GET_FORMVALUE', "ElementAddEdit", "ElementAddEdit");
		writeln('<input type=hidden name="ElementAddEdit" value="'+addEditMode+'">');
		writeln('<input type=hidden name="reqFields" value="'+reqFields+'">');
		writeln('<input type=hidden name="ElementID" value="'+merc_elementid+'">');
		write('</form>');

		writeln('<p align="center"><span class="dialog-title">Bill To Ship To</span></p>');
		writeln('<table width="407" border="0" cellspacing="0" cellpadding="0" align="center" class="table-bkgrd-main">');
		writeln('<tr valign="top"><td colspan="2" class="field-label"><center>');
	
	var reqFieldArr = reqFields.split("\t");
	write('<form action="javascript:void(0)" name="required">');
	writeln('<span class="instr-note">Select Required Fields</span>'+
		'<table  width="75%" border="1" align="center" cellpadding="2">'+
		'<tr class="table-header">'+ 
	   '<td class="field-label">'+ 
		'<div align="center">Billing Address</div></td>'+
		'<td class="field-label">'+ 
		'<div align="center">Required</div></td></tr>');
	writeln('<tr><td width="50%" align="center">Name: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToName" value="BillToName" '+(isInArray("BillToName", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">Address: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToAddress1" value="BillToAddress1" '+(isInArray("BillToAddress1", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">Address continued: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToAddress2" value="BillToAddress2" '+(isInArray("BillToAddress2", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">City: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToSubRegion" value="BillToSubRegion" '+(isInArray("BillToSubRegion", reqFieldArr) ? " CHECKED": "")+'></td></tr> '+      
	    '<tr><td width="50%" align="center">State/Province: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToRegion" value="BillToRegion" '+(isInArray("BillToRegion", reqFieldArr) ? " CHECKED": "")+'></td></tr> '+     
	    '<tr><td width="50%" align="center">Postal Code: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToPostalCode" value="BillToPostalCode" '+(isInArray("BillToPostalCode", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">Country: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToCountry" value="BillToCountry" '+(isInArray("BillToCountry", reqFieldArr) ? " CHECKED": "")+'></td></tr> '+     
	    '<tr><td width="50%" align="center">Daytime Phone: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToDaytimePhone" value="BillToDaytimePhone" '+(isInArray("BillToDaytimePhone", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">Evening Phone: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToEveningPhone" value="BillToEveningPhone" '+(isInArray("BillToEveningPhone", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">E-mail Address: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="BillToEmailAddress" value="BillToEmailAddress" '+(isInArray("BillToEmailAddress", reqFieldArr) ? " CHECKED": "")+'></td></tr>');      
	writeln('<tr class="table-header">'+ 
		'<td class="field-label">'+ 
		'<div align="center">Shipping Information</div></td>'+
		'<td class="field-label"> '+
		'<div align="center">Required</div></td></tr>'+  
		'<tr><td width="50%" align="center">Shipping: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="shippingZone" value="shippingZone" '+(isInArray("shippingZone", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+           
		'<tr class="table-header"> '+
		'<td class="field-label"> '+
		'<div align="center">Shipping Address<br>(if different from above)</div></td>'+
		'<td class="field-label">'+ 
		'<div align="center">Required</div></td></tr>');  
	writeln('<tr><td width="50%" align="center">Name: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="ShipToName" value="ShipToName" '+(isInArray("ShipToName", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">Address: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="ShipToAddress1" value="ShipToAddress1" '+(isInArray("ShipToAddress1", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	   '<tr><td width="50%" align="center">Address continued: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="ShipToAddress2" value="ShipToAddress2" '+(isInArray("ShipToAddress2", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+       
	    '<tr><td width="50%" align="center">City: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="ShipToSubRegion" value="ShipToSubRegion" '+(isInArray("ShipToSubRegion", reqFieldArr) ? " CHECKED": "")+'></td></tr> '+      
	    '<tr><td width="50%" align="center">State/Province: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="ShipToRegion" value="ShipToRegion" '+(isInArray("ShipToRegion", reqFieldArr) ? " CHECKED": "")+'></td></tr> '+     
	    '<tr><td width="50%" align="center">Postal Code: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="ShipToPostalCode" value="ShipToPostalCode" '+(isInArray("ShipToPostalCode", reqFieldArr) ? " CHECKED": "")+'></td></tr> '+      
	    '<tr><td width="50%" align="center">Country: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="ShipToCountry" value="ShipToCountry" '+(isInArray("ShipToCountry", reqFieldArr) ? " CHECKED": "")+'></td></tr> '+      
	    '<tr><td width="50%" align="center">Special Instructions: </td><td align="center"><input type="checkbox" class="table-bkgrd-main" name="Special" value="Special" '+(isInArray("Special", reqFieldArr) ? " CHECKED": "")+'></td></tr>'+
		'</table>');
		write('</form>');
		
<merc_embed>
	<SCRIPT language="javascript">
		function setFormVal()
		{
			var reqFlds = new Array();
			for (var n = 0; n < document.required.elements.length; n++)
			{
				if (document.required.elements[n].checked)
					reqFlds[reqFlds.length] = document.required.elements[n].value;
			}
			document.saveprop.reqFields.value = reqFlds.join("\t");
		}
	</SCRIPT>
</merc_embed>

		writeln('<table width="407" border="0" cellspacing="0" cellpadding="0" align="center" class="table-bkgrd-main">');
		writeln('<tr><td><center><br>');

<!--BEGIN HELP WINDOW LINK-->
var helpdomain = doAction('DATA_GETCONFIGDATA', 'ObjectName', 'HelpCfg', 'RowName', 'helpdomain', 'ColName', 'Domain');
var helpversion = doAction('DATA_GETCONFIGDATA', 'ObjectName', 'HelpCfg', 'RowName', 'helpversion', 'ColName', 'Domain');

writeln('<a href="javascript:void(opener.parent.openHelpWindow(\'http://'+helpdomain+'/cgi-bin/helpsrvr.exe?R+helpsrvr+OH_RTL_ELMT_BTST+SoftCart+'+helpversion+'+en-us\', \'Alane\'));"> <img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/help2.gif" width="97" height="30" border="0" name="help" alt="Help"></a>');<!--END HELP WINDOW LINK-->
		writeln('<a href="javascript:opener.CloseWinSubmitForm(\'PE_Cancel\', \'Layout1.htm\', \'mainFrame\', document.saveprop);"><img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/Cancel_Nbtn_base.gif" width="86" height="30" alt="Cancel" border="0"></a>');
		writeln('<a href="javascript:setFormVal();opener.CloseWinSubmitForm(\'PE_SaveProperties\', \'Layout1.htm\', \'mainFrame\', document.saveprop);">');
		writeln('<img src="/cgi-docs/Mercantec/PC_F_6.6.1/images/Save_Nbtn_base.gif" width="86" height="30" alt="Ok" border="0"></a>');
		writeln('</td></tr></table>');
		writeln('</td></tr></table>');
		writeln ("<SCRIPT language=javascript>");+
		writeln('self.resizeTo(500, 500);');
		writeln('</script>');

		return true;
	}
	]]></SCRIPT>
	<SCRIPT NAME="save_properties" TYPE="save_properties" VERSION="1.0"><![CDATA[
	// May not need to do anything in all cases
	// Save things to Prod DB on price/desc? - automatic based on dbentry
	// if there is a reason not to dismiss the properties dialog, return false
	function save_properties()
	{
		return true;
	}
	]]></SCRIPT>
	<SCRIPT NAME="create_element" TYPE="create_element" VERSION="1.0"><![CDATA[
	function create_element()
	{
		return true;
	}
	]]></SCRIPT>
	<SCRIPT NAME="destroy_element" TYPE="destroy_element" VERSION="1.0"><![CDATA[
	function destroy_element()
	{
		return true;
	}
	]]></SCRIPT>
</ELEMENT>
